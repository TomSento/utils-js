/*
    v=1.4.0 keys=malloc,toDebugStr,logPrefix,log,logDebug,logWarn,logError,test,genUID,genSID,genIID,objClone,objExtend,objKeys,objForIn,objToQueryStr,arrForEach,arrMap,arrFilter,arrFind,arrRemove,arrFirst,arrLast,arrOrderBy,arrHas,arrUnique,strPadStart,strPadEnd,strHyphenize,strFormat,strHTML,strStripHTML,strToHTMLText,strStripWhitespaces,strRemoveDiacritics,strSlug,strReplaceBetween,strReplaceCharAt,strReverse,strHas,strUntil,strFromUntil,strReverseUntil,strReverseFromUntil,strMatchLen,strToQueryObj,numToKeyType,error,ErrorBuilder,SETSCHEMA,SCHEMA,SETMODULE,MODULE,procSerial,ajax,domReady,domIsEl,domMatches,domFind,domHasClass,domAddClass,domRemoveClass,domToggleClass,domVal,domAttr,domData,domHTML,domText,domParent,domChildren,domSiblings,domPrev,domPrevAll,domNext,domNextAll,domStyle,domFadeIn,domFadeOut,domFadeTo,domFadeToggle,domOn,domOff,domTriggerNativeEvent,domTriggerEvent,domAppend,domPrepend,domRemove node compile
*/
var U = {
    malloc: function(prefix){if(!U.__cache){U.__cache={};}if(!U.__cache[prefix]){U.__cache[prefix]={};}var obj=U.__cache[prefix];return function(k,v){if(typeof(k)==='object'&&v===undefined){obj=k;return;}if(k===undefined&&v===undefined){return obj;}if(typeof(k)!=='string'){throw new Error('invalidParameter');}if(v===undefined){return obj[k];}else{obj[k]=v;}};},
    toDebugStr: function(){var str='';for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){if(typeof(arg)==='object'||Array.isArray(arg)){if(Array.isArray(arg)){str+='Array('+arg.length+'): \n';}else if(typeof(arg)==='object'){str+='Object: \n';}str+=JSON.stringify(arg,null,'    ');str+='\n';}else{str+=(i>0?' ':'')+arg;}}else{str+=(i>0?' ':'')+arg;}}return str;},
    logPrefix: function(str){var c=U.malloc('__LOG');c('prefix',str);},
    log: function(){var cache=U.malloc('__LOG');var args=[].slice.call(arguments);if(cache('prefix')){args.unshift(cache('prefix')+':');}console.log.apply(null,args);},
    logDebug: function(){var cache=U.malloc('__LOG');var args=[].slice.call(arguments);var log=U.toDebugStr.apply(this,args);var prefix=cache('prefix')?(cache('prefix')+': '):'';console.log(prefix+log);},
    logWarn: function(){var cache=U.malloc('__LOG');var args=[].slice.call(arguments);if(cache('prefix')){args.unshift(cache('prefix')+':');}console.warn.apply(null,args);},
    logError: function(){var cache=U.malloc('__LOG');var args=[].slice.call(arguments);if(cache('prefix')){args.unshift(cache('prefix')+':');}console.error.apply(null,args);},
    test: function(k,fn,maxTimeout){if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}if(typeof(fn)!=='function'){throw new Error('invalidParameter');}var cache=U.malloc('__TEST');var runner=cache('runner');var env=cache('env');if(env&&runner){runner.addTest(k,fn,maxTimeout);}else{env=getEnv();if(env){cache('env',env);runner=new TestRunner(env);runner.addTest(k,fn,maxTimeout);runner.run();cache('runner',runner);}else{throw new Error('unknownEnvironment');}}function getEnv(){var Env=function(env,type){var self=this;self.env=env;self.type=type;self.fns={};if(self.type==='BROWSER'){self.env.onerror=function(msg,url,lin,col,err){var fn=self.fns['windowError'];if(fn){fn(err);return true;}};}else if(self.type==='NODE'){self.env.on('uncaughtException',function(err){var fn=self.fns['uncaughtProcessException'];if(fn){fn(err);}});self.env.on('unhandledRejection',function(err){var fn=self.fns['unhandledProcessRejection'];if(fn){fn(err);}});}};Env.prototype={isNode:function(){var self=this;return self.type==='NODE';},on:function(k,fn){var self=this;self.fns[k]=fn;}};if(typeof(process)==='object'){return new Env(process,'NODE');}else if(typeof(window)==='object'){return new Env(window,'BROWSER');}else{return null;}}function TestRunner(env){var Co=function(){var self=this;self.env=env;self.tests=[];self.emitter=new EventEmitter();self.results=new TestResults();self.logger=new ResultLogger(env);self.terminated=false;self.finalizeTimeout=5000;self.findTest=function(k){for(var i=0;i<self.tests.length;i++){var v=self.tests[i];if(v&&v.id===k){return v;}}return null;};self.runNextTest=function(ms){var test=self.tests.shift();if(test){test.run();}else{if(ms>=self.finalizeTimeout){return self.finalize();}setTimeout(function(){ms=ms||0;self.runNextTest(ms+=500);},500);}};self.finalize=function(){var self=this;self.logger.logResults(self.results.results);};self.canRunNextTest=function(){return!self.terminated;};self.env.on('windowError',function(err){self.emitter.trigger('error',[err,'windowError']);});self.env.on('uncaughtProcessException',function(err){self.emitter.trigger('error',[err,'uncaughtException']);});self.env.on('unhandledProcessRejection',function(err){self.emitter.trigger('error',[err,'unhandledRejection']);});};Co.prototype={addTest:function(k,fn,maxTimeout){var self=this;if(self.findTest(k)){throw new Error('testDuplicate');}self.tests.push(new Test(k,fn,self.emitter,maxTimeout));},run:function(){var self=this;self.emitter.on('runNextTest',function(){if(self.canRunNextTest()){self.runNextTest();}});self.emitter.on('error',function(err){self.terminated=true;var msg=err[0]?(': '+err[0].stack):'';U.logError('TEST ERROR DETECTION [ENV:'+self.env.type+'] ('+err[1]+')'+msg);if(self.env.isNode()){self.env.env.exit(1);}});self.emitter.on('assert.result',function(result){self.results.push(result);});self.emitter.trigger('runNextTest');}};return new Co();}function Test(k,fn,emitter,maxTimeout){var Co=function(){var self=this;self.id=k;self.fn=fn;self.emitter=emitter;self.assert=new Assert(k,emitter);self.maxTimeout=maxTimeout||20000;self.execTime=0;self.startInterval=function(){self.interval=setInterval(function(){self.execTime+=500;if(self.execTime>=self.maxTimeout){var err=new Error("Test '"+self.id+"' exceeded maxTimeout "+self.maxTimeout+'ms.');return self.emitter.trigger('error',[err,'timingError']);}},500);};self.runNextTest=function(){clearInterval(self.interval);self.assert.onTestEnd();self.emitter.trigger('runNextTest');};};Co.prototype={run:function(){var self=this;self.startInterval();try{self.fn(self.assert);}catch(error){return self.emitter.trigger('error',[error,'syncError']);}if(self.isAsync()){self.emitter.on('assert.asyncTestEnded',function(){self.runNextTest();});}else{self.runNextTest();}},isAsync:function(){var self=this;return self.assert.isAsync;}};return new Co();}function Assert(testName,emitter){var Co=function(){var self=this;self.testName=testName;self.emitter=emitter;self.isAsync=false;self.callbackCounter=-1;self.expectedAssertions=0;self.assertionCounter=0;self.callback=function(){self.callbackCounter--;if(self.callbackCounter===0){self.emitter.trigger('assert.asyncTestEnded');}};self.onTestEnd=function(){if(self.expectedAssertions>0&&self.expectedAssertions!==self.assertionCounter){var b='Expected '+self.expectedAssertions;b+=self.expectedAssertions===1?' assertion':' assertions';b+=', but '+self.assertionCounter;b+=self.assertionCounter===1?' was run.':' were run.';self.emitter.trigger('assert.result',self.composeAssertionResult(b,undefined,null,new Error('assert.notOk')));}};self.composeAssertionResult=function(msg,expected,actual,err){return{testName:self.testName,msg:msg,expected:expected,actual:actual,err:err};};};Co.prototype={ok:function(bool,msg){var self=this;self.assertionCounter++;if(bool){return self.emitter.trigger('assert.result',self.composeAssertionResult(msg,true,true,null));}else{return self.emitter.trigger('assert.result',self.composeAssertionResult(msg,true,false,new Error('assert.ok')));}},notOk:function(bool,msg){var self=this;self.assertionCounter++;if(!bool){return self.emitter.trigger('assert.result',self.composeAssertionResult(msg,false,false,null));}else{return self.emitter.trigger('assert.result',self.composeAssertionResult(msg,false,true,new Error('assert.notOk')));}},async:function(expectedCallbacks){var self=this;if(isNaN(parseInt(expectedCallbacks))||expectedCallbacks<=0){throw new Error('invalidParameter');}self.isAsync=true;self.callbackCounter=expectedCallbacks;return self.callback;},expect:function(expectedAssertions){var self=this;if(isNaN(parseInt(expectedAssertions))||expectedAssertions<=0){throw new Error('invalidParameter');}self.expectedAssertions=expectedAssertions;}};return new Co();}function TestResults(){var Co=function(){var self=this;self.results={};self.composeTestResult=function(results,passed){return{results:results,passed:passed};};};Co.prototype={push:function(result){var self=this;if(!self.results[result.testName]){self.results[result.testName]=self.composeTestResult([],true);}self.results[result.testName].results.push(result);if(result.err){self.results[result.testName].passed=false;}}};return new Co();}function ResultLogger(env){var Co=function(){var self=this;self.logger=env.isNode()?new NodeLogger():new BrowserLogger();self.logger.initialLog();self.composeResultsForLogger=function(results,passed,failed){return{results:results,passed:passed,failed:failed};};self.prepareResults=function(results){var passed=0;var failed=0;for(var k in results){if(results.hasOwnProperty(k)){var v=results[k];if(v.passed){passed++;}else{failed++;}}}return self.composeResultsForLogger(results,passed,failed);};self.getAssertErrorsStr=function(results){var b='';for(var i=0;i<results.length;i++){var v=results[i];if(v.err){b+='  ---\n';b+="  message: '"+v.msg+"'\n";b+='  severity: failed\n';b+='  actual: '+v.actual+'\n';b+='  expected: '+v.expected+'\n';b+='  stack: '+v.err.stack+'\n';b+='  ...\n';}}return b;};};Co.prototype={logResults:function(results){var self=this;results=self.prepareResults(results);var i=0;for(var k in results.results){if(results.results.hasOwnProperty(k)){self.logger.logTestResult(i,k,results.results[k].results,self.getAssertErrorsStr);i++;}}self.logger.logFooter(results);}};return new Co();}function BrowserLogger(){var Co=function(){var self=this;self.domReady=function(fn){var d=document;if(d.readyState==='complete'||d.readyState!=='loading'){fn();}else{d.addEventListener('DOMContentLoaded',fn);}};};Co.prototype={initialLog:function(){var self=this;self.domReady(function(){var d=document;var el=d.getElementById('tests');if(!el){el=d.createElement('div');el.setAttribute('id','tests');el.style.fontFamily='"Courier New", Courier, monospace';el.style.fontSize=12+'px';}var line=d.createElement('div');line.textContent='TAP version 13';el.appendChild(line);var body=d.querySelector('body');if(body){body.appendChild(el);}});},logTestResult:function(i,testName,results,getAssertErrorsStr){var d=document;results=getAssertErrorsStr(results);var el=d.createElement('div');if(results){el.style.color='red';el.textContent='not ok '+(i+1)+' '+testName;d.getElementById('tests').appendChild(el);el=d.createElement('pre');el.style.margin='0 0 15px 0';el.style.fontFamily='inherit';el.textContent=results;d.getElementById('tests').appendChild(el);}else{el.textContent='ok '+(i+1)+' '+testName;d.getElementById('tests').appendChild(el);}},logFooter:function(results){var d=document;var el=d.createElement('div');el.textContent='1..'+(results.passed+results.failed);d.getElementById('tests').appendChild(el);el=d.createElement('div');el.textContent='# pass '+results.passed;d.getElementById('tests').appendChild(el);el=d.createElement('div');el.style.color='red';el.textContent='# fail '+results.failed;d.getElementById('tests').appendChild(el);}};return new Co();}function NodeLogger(){var Co=function(){};Co.prototype={initialLog:function(){console.log('TAP version 13');},logTestResult:function(i,testName,results,getAssertErrorsStr){results=getAssertErrorsStr(results);if(results){console.log('\x1b[31mnot ok '+(i+1)+' '+testName+'\x1b[0m');console.log(results);}else{console.log('ok '+(i+1)+' '+testName);}},logFooter:function(results){console.log('1..'+(results.passed+results.failed));console.log('# pass '+results.passed);console.log('\x1b[31m# fail '+results.failed+'\x1b[0m');}};return new Co();}function EventEmitter(){var Co=function(){this.fns={};};Co.prototype={on:function(k,fn){this.fns[k]=fn;},trigger:function(k,v){var fn=this.fns[k];if(fn){fn(v);}}};return new Co();}},
    genUID: function(){var d=new Date();var mo=twoPlaces(d.getMonth()+1);var day=twoPlaces(d.getDate());var h=twoPlaces(d.getHours());var min=twoPlaces(d.getMinutes());var arr=[d.getFullYear(),mo,day,h,min,U.genSID(3)];return arr.join('-');function twoPlaces(v){return v<10?('0'+v):v;}},
    genSID: function(len){var chars='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';len=parseInt(len);len=isNaN(len)?5:len;if(len<0){throw new Error('invalidParameter');}var str='';if(len>0){for(var i=0;i<len;i++){str+=chars.charAt(Math.floor(Math.random()*chars.length));}}var cache=U.malloc('__GEN');var c=cache('SID');c=c===undefined?0:(++c%2);c=''+c;cache('SID',c);return(str.length>0)?(str+'-'+c):c;},
    genIID: function(len){var c=U.malloc('__GEN');len=parseInt(len);len=isNaN(len)?3:len;if(len<=0){throw new Error('invalidParameter');}var chars='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');var num=chars.length;var prefix='SID_'+len;var i=0;var arr=[];if(c(prefix)){arr=c(prefix).arr;var b='';for(i;i<len;i++){b+=chars[arr[i]];}i=len-1;if(arr[len-1]==(num-1)){while(arr[i]==(num-1)){arr[i]=0;i--;}if(i!=-1){arr[i]=(arr[i]+1)%num;}i=len-1;}else{arr[i]=(arr[i]+1)%num;}c(prefix).arr=arr;return b;}else{for(i;i<len;i++){arr[i]=0;}c(prefix,{arr:arr});return U.IID(len);}},
    objClone: function(obj,skip,skipFunctions){if(!obj){return obj;}var typ=typeof(obj);if(typ!=='object'||obj instanceof Date){return obj;}var len;var o;if(obj instanceof Array){len=obj.length;o=new Array(len);for(var i=0;i<len;i++){typ=typeof(obj[i]);if(typ!=='object'||obj[i]instanceof Date){if(skipFunctions&&typ==='function'){continue;}o[i]=obj[i];continue;}o[i]=U.objClone(obj[i],skip,skipFunctions);}return o;}o={};for(var m in obj){if(skip&&skip[m]){continue;}var val=obj[m];typ=typeof(val);if(typ!=='object'||val instanceof Date){if(skipFunctions&&typ==='function'){continue;}o[m]=val;continue;}o[m]=U.objClone(obj[m],skip,skipFunctions);}return o;},
    objExtend: function(base,obj,rewrite){if(!base||!obj){return base;}if(typeof(base)!=='object'||typeof(obj)!=='object'){return base;}if(rewrite===undefined){rewrite=true;}var keys=Object.keys(obj);var i=keys.length;while(i--){var key=keys[i];if(rewrite||base[key]===undefined){base[key]=U.objClone(obj[key]);}}return base;},
    objKeys: function(obj){var keys=[];var k;for(k in obj){if(obj.hasOwnProperty(k)){keys.push(k);}}return keys;},
    objForIn: function(obj,fn){var i=0;for(var k in obj){if(obj.hasOwnProperty(k)){fn(k,obj[k],i);i++;}}},
    objToQueryStr: function(obj){var arr=[];for(var k in obj){if(obj.hasOwnProperty(k)){var v=encodeVal(obj[k]);k=encodeURIComponent(k);if(k&&v){arr.push(k+'='+v);}}}var len=arr.length;return len>0?('?'+arr.join('&')):'';function encodeVal(any){var typ=Object.prototype.toString.call(any);switch(typ){case'[object Number]':return encodeURIComponent(any);case'[object String]':return strEncode(any);case'[object Array]':return arrEncode(any);case'[object Boolean]':return any?'1':'0';}return null;}function strEncode(str){var len=str.replace(/\s*/g,'').length;if(len==0){return null;}var map={' ':'%20','\t':'%09','\n':'%0A','\r':'%0D'};str=str.replace(/( |\t|\n|\r)/g,function(match,k){return map[k]||k;});return str||null;}function arrEncode(arr){var acc=[];var len=arr.length;for(var i=0;i<len;i++){var v=encodeVal(arr[i]);if(v){acc.push(v);}}len=acc.length;return len>0?acc.join(','):null;}},
    arrForEach: function(arr,fn){var len=arr.length;for(var i=0;i<len;i++){fn(arr[i],i,arr);}},
    arrMap: function(arr,fn){var acc=[];for(var i=0;i<arr.length;i++){acc.push(fn(arr[i],i,arr));}return acc;},
    arrFilter: function(arr,fn){var acc=[];for(var i=0;i<arr.length;i++){if(fn.call(null,arr[i],i,arr)){acc.push(arr[i]);}}return acc;},
    arrFind: function(arr,fn){for(var i=0;i<arr.length;i++){if(fn.call(null,arr[i],i,arr)){return arr[i];}}return null;},
    arrRemove: function(arr,fn,v){var isFN=typeof(fn)==='function';var isV=v!==undefined;var tmp=[];for(var i=0,len=arr.length;i<len;i++){if(isFN){if(!fn.call(arr,arr[i],i)){tmp.push(arr[i]);}continue;}if(isV){if(arr[i]&&arr[i][fn]!==v){tmp.push(arr[i]);}continue;}if(arr[i]!==fn){tmp.push(arr[i]);}}return tmp;},
    arrFirst: function(arr){return arr[0]||null;},
    arrLast: function(arr){return arr[arr.length-1]||null;},
    arrOrderBy: function(arr,name,asc,maxlength){var length=arr.length;if(!length||length===1){return arr;}if(typeof(name)==='boolean'){asc=name;name=undefined;}if(maxlength===undefined){maxlength=3;}if(asc===undefined){asc=true;}var type=0;var field=name?arr[0][name]:arr[0];switch(typeof(field)){case'string':type=1;break;case'number':type=2;break;case'boolean':type=3;break;default:if(!(field instanceof Date)&&!isNaN(field.getTime())){return arr;}type=4;break;}function shellInsertionSort(list,length,gapSize,fn){var i=0;var j=0;var temp=null;for(i=gapSize;i<length;i+=gapSize){j=i;while(j>0&&fn(list[j-gapSize],list[j])===1){temp=list[j];list[j]=list[j-gapSize];list[j-gapSize]=temp;j-=gapSize;}}}function shellsort(arr,fn){var length=arr.length;var gapSize=Math.floor(length/2);while(gapSize){shellInsertionSort(arr,length,gapSize,fn);gapSize=Math.floor(gapSize/2);}return arr;}shellsort(arr,function(a,b){var va=name?a[name]:a;var vb=name?b[name]:b;if(type===1){if(va&&vb){if(asc){return U.strRemoveDiacritics(va.substring(0,maxlength)).localeCompare(U.strRemoveDiacritics(vb.substring(0,maxlength)));}else{return U.strRemoveDiacritics(vb.substring(0,maxlength)).localeCompare(U.strRemoveDiacritics(va.substring(0,maxlength)));}}else{return 0;}}else if(type===2){if(va>vb){return asc?1:-1;}else if(va<vb){return asc?-1:1;}else{return 0;}}else if(type===3){if(va===true&&vb===false){return asc?1:-1;}else if(va===false&&vb===true){return asc?-1:1;}else{return 0;}}else if(type===4){if(!va||!vb){return 0;}if(!va.getTime){va=new Date(va);}if(!vb.getTime){vb=new Date(vb);}var at=va.getTime();var bt=vb.getTime();if(at>bt){return asc?1:-1;}else if(at<bt){return asc?-1:1;}else{return 0;}}else{return 0;}});return arr;},
    arrHas: function(arr,v){return arr.indexOf(v)>=0;},
    arrUnique: function(arr,k){var result=[];var sublen=0;for(var i=0,len=arr.length;i<len;i++){var v=arr[i];if(!k){if(result.indexOf(v)===-1){result.push(v);}continue;}if(sublen===0){result.push(v);sublen++;continue;}var is=true;for(var j=0;j<sublen;j++){if(result[j][k]===v[k]){is=false;break;}}if(is){result.push(v);sublen++;}}return result;},
    strPadStart: function(str,len,fill){if(typeof(str)==='number'&&typeof(len)==='string'&&!fill){return''.padStart(str,len);}else if(typeof(str)==='string'&&typeof(len)==='number'&&typeof(fill)==='string'){return str.padStart(len,fill);}throw new Error('invalidParameter');},
    strPadEnd: function(str,len,fill){if(typeof(str)==='number'&&typeof(len)==='string'&&!fill){return''.padEnd(str,len);}else if(typeof(str)==='string'&&typeof(len)==='number'&&typeof(fill)==='string'){return str.padEnd(len,fill);}throw new Error('invalidParameter');},
    strHyphenize: function(str){if(typeof(str)!=='string'){return null;}return str.replace(/\B([A-Z])/g,function(g){return('-'+g[0]);}).toLowerCase();},
    strFormat: function(str,args){return str.replace(/\{\d+\}/g,function(text){var value=args[+text.substring(1,text.length-1)];return value===null?'':value;});},
    strHTML: function(tag,obj){if(!tag||typeof(tag)!=='string'){return'';}var pairables=['area','base','br','col','command','embed','hr','img','input','keygen','link','meta','param','source','track','wbr'];var str='<'+tag;if(!obj){obj={};}if(obj.id){str+=' id="'+obj.id+'"';}if(Array.isArray(obj.classes)){str+=classesAsStr(obj);}if(obj.style&&typeof(obj.style)==='object'){str+=stylesAsStr(obj.style);}str+=attrsAsStr(obj);if(obj.data&&typeof(obj.data)==='object'){str+=dataAttrsAsStr(obj.data);}if(pairables.indexOf(tag)>=0){return str+'/>';}str+='>';str+=obj.html;str+='</'+tag+'>';return str;function classesAsStr(obj){var arr=obj.classes;var str='';for(var i=0;i<arr.length;i++){var v=arr[i];if(v){v='.'+v;}}str=obj.classes.join(' ');return str.length>0?(' class="'+str+'"'):'';}function attrsAsStr(obj){obj=typeof(obj)==='object'?obj:{};var str='';for(var k in obj){if(['id','classes','style','data','html'].indexOf(k)>=0){continue;}var attr=k+'="'+obj[k]+'"';str+=str.length>0?(' '+attr):attr;}return str.length>0?(' '+str):'';}function dataAttrsAsStr(obj){var str='';for(var k in obj){if(obj.hasOwnProperty(k)){var attr='data-'+k+'="'+obj[k]+'"';str+=str.length>0?(' '+attr):attr;}}return str.length>0?(' '+str):'';}function stylesAsStr(obj){var str='';for(var k in obj){if(obj.hasOwnProperty(k)){str+=U.strHyphenize(k)+':'+obj[k]+';';}}return(str.length>0)?(' style="'+str+'"'):'';}},
    strStripHTML: function(str){str=typeof(str)==='string'?str.replace(/<\/?[^>]+(>|$)/g,''):'';var map={'nbsp':' ','amp':'&','quot':'"','lt':'<','gt':'>'};return str.replace(/&(nbsp|amp|quot|lt|gt);/g,function(match,k){return map[k]||k;});},
    strToHTMLText: function(str,leftStartWithNBPS,leftRevResult,rightStartWithNBPS,rightRevResult){var map={'&':'amp','"':'quot','<':'lt','>':'gt'};str=str.replace(/(&|"|<|>)/g,function(match,k){return('&'+map[k]+';')||k;});str=replaceMultipleWhitespacesBetweenChars(str);str=str.replace(/^\s+/,function(spaces){return generateSpaces(spaces.length,leftStartWithNBPS,leftRevResult);});str=str.replace(/\s+$/,function(spaces){return generateSpaces(spaces.length,rightStartWithNBPS,rightRevResult);});return str;function replaceMultipleWhitespacesBetweenChars(str){var exp=/[^\s](\s+)[^\s]/g;var match=null;while(match=exp.exec(str)){if(Array.isArray(match)){exp.lastIndex-=1;var i=match.index+1;var len=match[1].length;var part=generateSpaces(len,false,true);str=str.substring(0,i)+part+str.substring(i+len);}}return str;}function generateSpaces(len,startWithNBPS,revResult){var arr=[];for(var i=0;i<len;i++){if(i%2===0){arr[i]=startWithNBPS?'&nbsp;':' ';}else{arr[i]=startWithNBPS?' ':'&nbsp;';}}return revResult?arr.reverse().join(''):arr.join('');}},
    strStripWhitespaces: function(str){return typeof(str)==='string'?str.replace(/\s+/,''):'';},
    strRemoveDiacritics: function(str){var map={'\u00a0':' ','\u07c0':'0','\u24b6':'A','\uff21':'A','\u00c0':'A','\u00c1':'A','\u00c2':'A','\u1ea6':'A','\u1ea4':'A','\u1eaa':'A','\u1ea8':'A','\u00c3':'A','\u0100':'A','\u0102':'A','\u1eb0':'A','\u1eae':'A','\u1eb4':'A','\u1eb2':'A','\u0226':'A','\u01e0':'A','\u00c4':'A','\u01de':'A','\u1ea2':'A','\u00c5':'A','\u01fa':'A','\u01cd':'A','\u0200':'A','\u0202':'A','\u1ea0':'A','\u1eac':'A','\u1eb6':'A','\u1e00':'A','\u0104':'A','\u023a':'A','\u2c6f':'A','\ua732':'AA','\u00c6':'AE','\u01fc':'AE','\u01e2':'AE','\ua734':'AO','\ua736':'AU','\ua738':'AV','\ua73a':'AV','\ua73c':'AY','\u24b7':'B','\uff22':'B','\u1e02':'B','\u1e04':'B','\u1e06':'B','\u0243':'B','\u0181':'B','\u24b8':'C','\uff23':'C','\ua73e':'C','\u1e08':'C','\u0106C':'C','\u0108':'C','\u010a':'C','\u010c':'C','\u00c7':'C','\u0187':'C','\u023b':'C','\u24b9':'D','\uff24':'D','\u1e0a':'D','\u010e':'D','\u1e0c':'D','\u1e10':'D','\u1e12':'D','\u1e0e':'D','\u0110':'D','\u018a':'D','\u0189':'D','\u1d05':'D','\ua779':'D','\u00d0':'Dh','\u01f1':'DZ','\u01c4':'DZ','\u01f2':'Dz','\u01c5':'Dz','\u025b':'E','\u24ba':'E','\uff25':'E','\u00c8':'E','\u00c9':'E','\u00ca':'E','\u1ec0':'E','\u1ebe':'E','\u1ec4':'E','\u1ec2':'E','\u1ebc':'E','\u0112':'E','\u1e14':'E','\u1e16':'E','\u0114':'E','\u0116':'E','\u00cb':'E','\u1eba':'E','\u011a':'E','\u0204':'E','\u0206':'E','\u1eb8':'E','\u1ec6':'E','\u0228':'E','\u1e1c':'E','\u0118':'E','\u1e18':'E','\u1e1a':'E','\u0190':'E','\u018e':'E','\u1d07':'E','\ua77c':'F','\u24bb':'F','\uff26':'F','\u1e1e':'F','\u0191':'F','\ua77b':'F','\u24bc':'G','\uff27':'G','\u01f4':'G','\u011c':'G','\u1e20':'G','\u011e':'G','\u0120':'G','\u01e6':'G','\u0122':'G','\u01e4':'G','\u0193':'G','\ua7a0':'G','\ua77d':'G','\ua77e':'G','\u0262':'G','\u24bd':'H','\uff28':'H','\u0124':'H','\u1e22':'H','\u1e26':'H','\u021e':'H','\u1e24':'H','\u1e28':'H','\u1e2a':'H','\u0126':'H','\u2c67':'H','\u2c75':'H','\ua78d':'H','\u24be':'I','\uff29':'I','\u00cc':'I','\u00cd':'I','\u00ce':'I','\u0128':'I','\u012a':'I','\u012c':'I','\u0130':'I','\u00cf':'I','\u1e2e':'I','\u1ec8':'I','\u01cf':'I','\u0208':'I','\u020a':'I','\u1eca':'I','\u012e':'I','\u1e2c':'I','\u0197':'I','\u24bf':'J','\uff2a':'J','\u0134':'J','\u0248':'J','\u0237':'J','\u24c0':'K','\uff2b':'K','\u1e30':'K','\u01e8':'K','\u1e32':'K','\u0136':'K','\u1e34':'K','\u0198':'K','\u2c69':'K','\ua740':'K','\ua742':'K','\ua744':'K','\ua7a2':'K','\u24c1':'L','\uff2c':'L','\u013f':'L','\u0139':'L','\u013d':'L','\u1e36':'L','\u1e38':'L','\u013b':'L','\u1e3c':'L','\u1e3a':'L','\u0141':'L','\u023d':'L','\u2c62':'L','\u2c60':'L','\ua748':'L','\ua746':'L','\ua780':'L','\u01c7':'LJ','\u01c8':'Lj','\u24c2':'M','\uff2d':'M','\u1e3e':'M','\u1e40':'M','\u1e42':'M','\u2c6e':'M','\u019c':'M','\u03fb':'M','\ua7a4':'N','\u0220':'N','\u24c3':'N','\uff2e':'N','\u01f8':'N','\u0143':'N','\u00d1':'N','\u1e44':'N','\u0147':'N','\u1e46':'N','\u0145':'N','\u1e4a':'N','\u1e48':'N','\u019d':'N','\ua790':'N','\u1d0e':'N','\u01ca':'NJ','\u01cb':'Nj','\u24c4':'O','\uff2f':'O','\u00d2':'O','\u00d3':'O','\u00d4':'O','\u1ed2':'O','\u1ed0':'O','\u1ed6':'O','\u1ed4':'O','\u00d5':'O','\u1e4c':'O','\u022c':'O','\u1e4e':'O','\u014c':'O','\u1e50':'O','\u1e52':'O','\u014e':'O','\u022e':'O','\u0230':'O','\u00d6':'O','\u022a':'O','\u1ece':'O','\u0150':'O','\u01d1':'O','\u020c':'O','\u020e':'O','\u01a0':'O','\u1edc':'O','\u1eda':'O','\u1ee0':'O','\u1ede':'O','\u1ee2':'O','\u1ecc':'O','\u1ed8':'O','\u01ea':'O','\u01ec':'O','\u00d8':'O','\u01fe':'O','\u0186':'O','\u019f':'O','\ua74a':'O','\ua74c':'O','\u0152':'OE','\u01a2':'OI','\ua74e':'OO','\u0222':'OU','\u24c5':'P','\uff30':'P','\u1e54':'P','\u1e56':'P','\u01a4':'P','\u2c63':'P','\ua750':'P','\ua752':'P','\ua754':'P','\u24c6':'Q','\uff31':'Q','\ua756':'Q','\ua758':'Q','\u024a':'Q','\u24c7':'R','\uff32':'R','\u0154':'R','\u1e58':'R','\u0158':'R','\u0210':'R','\u0212':'R','\u1e5a':'R','\u1e5c':'R','\u0156':'R','\u1e5e':'R','\u024c':'R','\u2c64':'R','\ua75a':'R','\ua7a6':'R','\ua782':'R','\u24c8':'S','\uff33':'S','\u1e9e':'S','\u015a':'S','\u1e64':'S','\u015c':'S','\u1e60':'S','\u0160':'S','\u1e66':'S','\u1e62':'S','\u1e68':'S','\u0218':'S','\u015e':'S','\u2c7e':'S','\ua7a8':'S','\ua784':'S','\u24c9':'T','\uff34':'T','\u1e6a':'T','\u0164':'T','\u1e6c':'T','\u021a':'T','\u0162':'T','\u1e70':'T','\u1e6e':'T','\u0166':'T','\u01ac':'T','\u01ae':'T','\u023e':'T','\ua786':'T','\u00de':'Th','\ua728':'TZ','\u24ca':'U','\uff35':'U','\u00d9':'U','\u00da':'U','\u00db':'U','\u0168':'U','\u1e78':'U','\u016a':'U','\u1e7a':'U','\u016c':'U','\u00dc':'U','\u01db':'U','\u01d7':'U','\u01d5':'U','\u01d9':'U','\u1ee6':'U','\u016e':'U','\u0170':'U','\u01d3':'U','\u0214':'U','\u0216':'U','\u01af':'U','\u1eea':'U','\u1ee8':'U','\u1eee':'U','\u1eec':'U','\u1ef0':'U','\u1ee4':'U','\u1e72':'U','\u0172':'U','\u1e76':'U','\u1e74':'U','\u0244':'U','\u24cb':'V','\uff36':'V','\u1e7c':'V','\u1e7e':'V','\u01b2':'V','\ua75e':'V','\u0245':'V','\ua760':'VY','\u24cc':'W','\uff37':'W','\u1e80':'W','\u1e82':'W','\u0174':'W','\u1e86':'W','\u1e84':'W','\u1e88':'W','\u2c72':'W','\u24cd':'X','\uff38':'X','\u1e8a':'X','\u1e8c':'X','\u24ce':'Y','\uff39':'Y','\u1ef2':'Y','\u00dd':'Y','\u0176':'Y','\u1ef8':'Y','\u0232':'Y','\u1e8e':'Y','\u0178':'Y','\u1ef6':'Y','\u1ef4':'Y','\u01b3':'Y','\u024e':'Y','\u1efe':'Y','\u24cf':'Z','\uff3a':'Z','\u0179':'Z','\u1e90':'Z','\u017b':'Z','\u017d':'Z','\u1e92':'Z','\u1e94':'Z','\u01b5':'Z','\u0224':'Z','\u2c7f':'Z','\u2c6b':'Z','\ua762':'Z','\u24d0':'a','\uff41':'a','\u1e9a':'a','\u00e0':'a','\u00e1':'a','\u00e2':'a','\u1ea7':'a','\u1ea5':'a','\u1eab':'a','\u1ea9':'a','\u00e3':'a','\u0101':'a','\u0103':'a','\u1eb1':'a','\u1eaf':'a','\u1eb5':'a','\u1eb3':'a','\u0227':'a','\u01e1':'a','\u00e4':'a','\u01df':'a','\u1ea3':'a','\u00e5':'a','\u01fb':'a','\u01ce':'a','\u0201':'a','\u0203':'a','\u1ea1':'a','\u1ead':'a','\u1eb7':'a','\u1e01':'a','\u0105':'a','\u2c65':'a','\u0250':'a','\u0251':'a','\ua733':'aa','\u00e6':'ae','\u01fd':'ae','\u01e3':'ae','\ua735':'ao','\ua737':'au','\ua739':'av','\ua73b':'av','\ua73d':'ay','\u24d1':'b','\uff42':'b','\u1e03':'b','\u1e05':'b','\u1e07':'b','\u0180':'b','\u0183':'b','\u0253':'b','\u0182':'b','\uff43':'c','\u24d2':'c','\u0107':'c','\u0109':'c','\u010b':'c','\u010d':'c','\u00e7':'c','\u1e09':'c','\u0188':'c','\u023c':'c','\ua73f':'c','\u2184':'c','\u24d3':'d','\uff44':'d','\u1e0b':'d','\u010f':'d','\u1e0d':'d','\u1e11':'d','\u1e13':'d','\u1e0f':'d','\u0111':'d','\u018c':'d','\u0256':'d','\u0257':'d','\u018b':'d','\u13e7':'d','\u0501':'d','\ua7aa':'d','\u00f0':'dh','\u01f3':'dz','\u01c6':'dz','\u24d4':'e','\uff45':'e','\u00e8':'e','\u00e9':'e','\u00ea':'e','\u1ec1':'e','\u1ebf':'e','\u1ec5':'e','\u1ec3':'e','\u1ebd':'e','\u0113':'e','\u1e15':'e','\u1e17':'e','\u0115':'e','\u0117':'e','\u00eb':'e','\u1ebb':'e','\u011b':'e','\u0205':'e','\u0207':'e','\u1eb9':'e','\u1ec7':'e','\u0229':'e','\u1e1d':'e','\u0119':'e','\u1e19':'e','\u1e1b':'e','\u0247':'e','\u01dd':'e','\u24d5':'f','\uff46':'f','\u1e1f':'f','\u0192':'f','\ufb00':'ff','\ufb01':'fi','\ufb02':'fl','\ufb03':'ffi','\ufb04':'ffl','\u24d6':'g','\uff47':'g','\u01f5':'g','\u011d':'g','\u1e21':'g','\u011f':'g','\u0121':'g','\u01e7':'g','\u0123':'g','\u01e5':'g','\u0260':'g','\ua7a1':'g','\ua77f':'g','\u1d79':'g','\u24d7':'h','\uff48':'h','\u0125':'h','\u1e23':'h','\u1e27':'h','\u021f':'h','\u1e25':'h','\u1e29':'h','\u1e2b':'h','\u1e96':'h','\u0127':'h','\u2c68':'h','\u2c76':'h','\u0265':'h','\u0195':'hv','\u24d8':'i','\uff49':'i','\u00ec':'i','\u00ed':'i','\u00ee':'i','\u0129':'i','\u012b':'i','\u012d':'i','\u00ef':'i','\u1e2f':'i','\u1ec9':'i','\u01d0':'i','\u0209':'i','\u020b':'i','\u1ecb':'i','\u012f':'i','\u1e2d':'i','\u0268':'i','\u0131':'i','\u24d9':'j','\uff4a':'j','\u0135':'j','\u01f0':'j','\u0249':'j','\u24da':'k','\uff4b':'k','\u1e31':'k','\u01e9':'k','\u1e33':'k','\u0137':'k','\u1e35':'k','\u0199':'k','\u2c6a':'k','\ua741':'k','\ua743':'k','\ua745':'k','\ua7a3':'k','\u24db':'l','\uff4c':'l','\u0140':'l','\u013a':'l','\u013e':'l','\u1e37':'l','\u1e39':'l','\u013c':'l','\u1e3d':'l','\u1e3b':'l','\u017f':'l','\u0142':'l','\u019a':'l','\u026b':'l','\u2c61':'l','\ua749':'l','\ua781':'l','\ua747':'l','\u026d':'l','\u01c9':'lj','\u24dc':'m','\uff4d':'m','\u1e3f':'m','\u1e41':'m','\u1e43':'m','\u0271':'m','\u026f':'m','\u24dd':'n','\uff4e':'n','\u01f9':'n','\u0144':'n','\u00f1':'n','\u1e45':'n','\u0148':'n','\u1e47':'n','\u0146':'n','\u1e4b':'n','\u1e49':'n','\u019e':'n','\u0272':'n','\u0149':'n','\ua791':'n','\ua7a5':'n','\u043b':'n','\u0509':'n','\u01cc':'nj','\u24de':'o','\uff4f':'o','\u00f2':'o','\u00f3':'o','\u00f4':'o','\u1ed3':'o','\u1ed1':'o','\u1ed7':'o','\u1ed5':'o','\u00f5':'o','\u1e4d':'o','\u022d':'o','\u1e4f':'o','\u014d':'o','\u1e51':'o','\u1e53':'o','\u014f':'o','\u022f':'o','\u0231':'o','\u00f6':'o','\u022b':'o','\u1ecf':'o','\u0151':'o','\u01d2':'o','\u020d':'o','\u020f':'o','\u01a1':'o','\u1edd':'o','\u1edb':'o','\u1ee1':'o','\u1edf':'o','\u1ee3':'o','\u1ecd':'o','\u1ed9':'o','\u01eb':'o','\u01ed':'o','\u00f8':'o','\u01ff':'o','\ua74b':'o','\ua74d':'o','\u0275':'o','\u0254':'o','\u1d11':'o','\u0153':'oe','\u01a3':'oi','\ua74f':'oo','\u0223':'ou','\u24df':'p','\uff50':'p','\u1e55':'p','\u1e57':'p','\u01a5':'p','\u1d7d':'p','\ua751':'p','\ua753':'p','\ua755':'p','\u03c1':'p','\u24e0':'q','\uff51':'q','\u024b':'q','\ua757':'q','\ua759':'q','\u24e1':'r','\uff52':'r','\u0155':'r','\u1e59':'r','\u0159':'r','\u0211':'r','\u0213':'r','\u1e5b':'r','\u1e5d':'r','\u0157':'r','\u1e5f':'r','\u024d':'r','\u027d':'r','\ua75b':'r','\ua7a7':'r','\ua783':'r','\u24e2':'s','\uff53':'s','\u015b':'s','\u1e65':'s','\u015d':'s','\u1e61':'s','\u0161':'s','\u1e67':'s','\u1e63':'s','\u1e69':'s','\u0219':'s','\u015f':'s','\u023f':'s','\ua7a9':'s','\ua785':'s','\u1e9b':'s','\u0282':'s','\u00df':'ss','\u24e3':'t','\uff54':'t','\u1e6b':'t','\u1e97':'t','\u0165':'t','\u1e6d':'t','\u021b':'t','\u0163':'t','\u1e71':'t','\u1e6f':'t','\u0167':'t','\u01ad':'t','\u0288':'t','\u2c66':'t','\ua787':'t','\u00fe':'th','\ua729':'tz','\u24e4':'u','\uff55':'u','\u00f9':'u','\u00fa':'u','\u00fb':'u','\u0169':'u','\u1e79':'u','\u016b':'u','\u1e7b':'u','\u016d':'u','\u00fc':'u','\u01dc':'u','\u01d8':'u','\u01d6':'u','\u01da':'u','\u1ee7':'u','\u016f':'u','\u0171':'u','\u01d4':'u','\u0215':'u','\u0217':'u','\u01b0':'u','\u1eeb':'u','\u1ee9':'u','\u1eef':'u','\u1eed':'u','\u1ef1':'u','\u1ee5':'u','\u1e73':'u','\u0173':'u','\u1e77':'u','\u1e75':'u','\u0289':'u','\u24e5':'v','\uff56':'v','\u1e7d':'v','\u1e7f':'v','\u028b':'v','\ua75f':'v','\u028c':'v','\ua761':'vy','\u24e6':'w','\uff57':'w','\u1e81':'w','\u1e83':'w','\u0175':'w','\u1e87':'w','\u1e85':'w','\u1e98':'w','\u1e89':'w','\u2c73':'w','\u24e7':'x','\uff58':'x','\u1e8b':'x','\u1e8d':'x','\u24e8':'y','\uff59':'y','\u1ef3':'y','\u00fd':'y','\u0177':'y','\u1ef9':'y','\u0233':'y','\u1e8f':'y','\u00ff':'y','\u1ef7':'y','\u1e99':'y','\u1ef5':'y','\u01b4':'y','\u024f':'y','\u1eff':'y','\u24e9':'z','\uff5a':'z','\u017a':'z','\u1e91':'z','\u017c':'z','\u017e':'z','\u1e93':'z','\u1e95':'z','\u01b6':'z','\u0225':'z','\u0240':'z','\u2c6c':'z','\ua763':'z'};var expDiacritics=/[^\u0000-\u007e]/g;return str.replace(expDiacritics,function(ch){return map[ch]||ch;});},
    strSlug: function(str,max){max=max||60;var self=U.strRemoveDiacritics(str.trim().toLowerCase());var builder='';var length=self.length;for(var i=0;i<length;i++){var c=self[i];var code=self.charCodeAt(i);if(builder.length>=max){break;}if(code>31&&code<48){if(builder[builder.length-1]!=='-'){builder+='-';}continue;}if((code>47&&code<58)||(code>94&&code<123)){builder+=c;}}var l=builder.length-1;return builder[l]==='-'?builder.substring(0,l):builder;},
    strReplaceBetween: function(str,i,j,part){return str.substring(0,i)+part+str.substring(j);},
    strReplaceCharAt: function(str,i,ch){return str.substr(0,i)+ch+str.substr(i+ch.length);},
    strReverse: function(str){var rev='';for(var i=str.length-1;i>=0;i--){rev+=str[i];}return rev;},
    strHas: function(str,v){return str.includes(v);},
    strUntil: function(str,exp){var arr=str.split(exp);return(Array.isArray(arr)&&arr[0])?arr[0]:'';},
    strFromUntil: function(str,leftIndex,exp){str=str.substring(leftIndex);var arr=str.split(exp);return(Array.isArray(arr)&&arr[0])?arr[0]:'';},
    strReverseUntil: function(str,exp){var rev='';for(var i=str.length-1;i>=0;i--){rev+=str[i];}var arr=rev.split(exp);return(Array.isArray(arr)&&arr[0])?arr[0]:'';},
    strReverseFromUntil: function(str,leftIndex,exp){str=str.substring(0,leftIndex);var rev='';for(var i=str.length-1;i>=0;i--){rev+=str[i];}var arr=rev.split(exp);return(Array.isArray(arr)&&arr[0])?arr[0]:'';},
    strMatchLen: function(str,regex,i){var matches=str.match(regex);i=parseInt(i);i=isNaN(i)?0:i;return(Array.isArray(matches)&&matches[i])?matches[i].length:0;},
    strToQueryObj: function(url){url=url.replace(/\+/g,' ');var exp=/[?&]([^=#]+)=([^&#]*)/g;var o={};var m=null;while(m=exp.exec(url)){var k=decodeURIComponent(m[1]);var v=decodeURIComponent(m[2]);o[k]=v;}return o;},
    numToKeyType: function(keyCode){var map={8:'BACKSPACE',9:'TAB',13:'ENTER',16:'SHIFT',17:'CTRL',18:'ALT',32:'SPACE',37:'LEFT_ARROW',38:'UP_ARROW',39:'RIGHT_ARROW',40:'DOWN_ARROW',65:'A',66:'B',67:'C',68:'D',69:'E',70:'F',71:'G',72:'H',73:'I',74:'J',75:'K',76:'L',77:'M',78:'N',79:'O',80:'P',81:'Q',82:'R',83:'S',84:'T',85:'U',86:'V',87:'W',88:'X',89:'Y',90:'Z'};return map[keyCode]||null;},
    error: function(problem,message){var Co=function(problem,message){if(!problem){throw new Error('invalidParameter');}if(problem instanceof Error){this.id=problem.message;}else if(typeof(problem)=='string'){this.id=problem;}else{throw new Error('invalidParameter');}this.message=message||null;};Co.prototype={log:function(){var str=this.id;if(this.message){str+=': '+this.message;}U.logWarn(str);},throw:function(){throw new Error(this.id);},logAndThrow:function(){this.log();this.throw();},toString:function(){return JSON.stringify(this,null,'    ');}};return new Co(problem,message);},
    ErrorBuilder: function(errors){var Co=function(errors){if(errors){if(!Array.isArray(errors)){throw new Error('invalidParameter');}for(var i=0;i<errors.length;i++){if(!errors[i]||!errors[i].id){throw new Error('invalidParameter');}}}this.errors=errors||[];};Co.prototype={push:function(err){if(err instanceof Error){err=U.error(err.message);}this.errors.push(err);},remove:function(id){var arr=this.errors;var i=-1;for(var j=0;j<arr.length;j++){if(arr[j].id==id){i=j;}}if(i>=0){arr.splice(i,1);}},clear:function(){this.errors=[];},first:function(){return this.errors[0]||null;},last:function(){return this.errors[this.errors.length-1]||null;},toString:function(){return JSON.stringify(this,null,'    ');},hasError:function(id){var arr=this.errors;if(id){for(var i=0;i<arr.length;i++){if(arr[i]&&arr[i].id==id){return true;}}return false;}return arr.length>0;},throwFirst:function(){var len=this.errors.length;if(len==0){throw new Error('emptyErrorBuilder');}this.errors[0].throw();},logFirst:function(){var len=this.errors.length;if(len==0){throw new Error('emptyErrorBuilder');}this.errors[0].log();},logAndThrowFirst:function(){var len=this.errors.length;if(len==0){throw new Error('emptyErrorBuilder');}this.errors[0].logAndThrow();}};return new Co(errors);},
    SETSCHEMA: function(k,fn){if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}if(typeof(fn)!=='function'){throw new Error('invalidParameter');}var Co=function(fn){this.rule={};this.prefix='';this.currentKey=null;var funcError=attrError;fn.apply(null,[attr.bind(this),attrError.bind(this),attrPrepare.bind(this),attrValidate.bind(this),func.bind(this),funcError.bind(this),setPrefix.bind(this)]);};Co.prototype={prepareAndValidate:function(obj,lan){if(!obj||typeof(obj)!=='object'){throw new Error('invalidParameter');}var eb=new U.ErrorBuilder();for(var k in this.rule){if(this.rule.hasOwnProperty(k)){var v=obj[k];var rule=this.rule[k];var mes=rule.message[lan]||rule.message['default']||('Invalid property "'+k+'".');if(rule.prepare){v=rule.prepare(v,obj);obj[k]=v;}var act=Object.prototype.toString.call(v);var mat=(act===rule.type);if(rule.validate&&!rule.validate(v,mat,obj,act,rule.type)){eb.push(U.error(this.prefix+k,mes));}}}return eb;},normalize:function(obj){var norm={};for(var k in this.rule){if(this.rule.hasOwnProperty(k)){var rule=this.rule[k];var val=obj[k];var typ=Object.prototype.toString.call(val);if(!val||typ!==rule.type){if(rule.type==='[object Array]'){norm[k]=[];}else if(rule.type=='[object Function]'){norm[k]=function(){};}else{norm[k]=null;}}else{norm[k]=val;}}}return norm;}};function attr(name,type){if(!name||typeof(name)!=='string'){throw new Error('invalidParameter');}type=strType(type);if(!type){throw new Error('invalidParameter');}this.currentKey=name;this.rule[this.currentKey]={type:type,message:{default:'Invalid attribute "'+name+'".'}};}function func(name){if(!name||typeof(name)!=='string'){throw new Error('invalidParameter');}this.currentKey=name;this.rule[this.currentKey]={type:'[object Function]',message:{default:'Invalid function "'+name+'".'}};}function attrError(a,b){if(!a||typeof(a)!=='string'){throw new Error('invalidParameter');}if(b&&typeof(b)!=='string'){throw new Error('invalidParameter');}var lan=(a&&b)?a:'default';var mes=(a&&b)?b:a;if(!this.rule[this.currentKey]){throw new Error('invalidOrder');}if(!this.rule[this.currentKey].message){this.rule[this.currentKey].message={};}this.rule[this.currentKey].message[lan]=mes;}function attrPrepare(fn){if(!fn||typeof(fn)!=='function'){throw new Error('invalidParameter');}if(!this.rule[this.currentKey]){throw new Error('invalidOrder');}this.rule[this.currentKey].prepare=fn;}function attrValidate(fn){if(!fn||typeof(fn)!=='function'){throw new Error('invalidParameter');}if(!this.rule[this.currentKey]){throw new Error('invalidOrder');}this.rule[this.currentKey].validate=fn;}function strType(type){if(type===Number){return'[object Number]';}else if(type===String){return'[object String]';}else if(type===Array){return'[object Array]';}else if(type===Date){return'[object Date]';}else if(type===Object){return'[object Object]';}else if(type===Boolean){return'[object Boolean]';}else{return null;}}function setPrefix(prefix){this.prefix=prefix;}var cache=U.malloc('__SCHEMA');if(cache(k)){throw new Error("Duplicate schema: '"+k+"'.");}cache(k,new Co(fn));},
    SCHEMA: function(k){if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}var cache=U.malloc('__SCHEMA');return cache(k)||null;},
    SETMODULE: function(k,fn){if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}if(typeof(fn)!=='function'){throw new Error('invalidParameter');}var Co=function(){var self=this;self.fns={};self.registerFN=function(kk,func){if(!kk||typeof(kk)!=='string'){throw new Error('invalidParameter');}if(typeof(func)!=='function'){throw new Error('invalidParameter');}if(self.fns[kk]){throw new Error("Duplicate function: '"+kk+"' in '"+k+"' module.");}self.fns[kk]=func;};fn(self.registerFN);};Co.prototype={func:function(){var self=this;var args=[].slice.call(arguments);var kk=args.shift();if(!kk||typeof(kk)!=='string'){throw new Error('invalidParameter');}var func=self.fns[kk];if(!func){throw new Error("Function: '"+kk+"' in '"+k+"' module was not found.");}return func.apply(null,args);}};var cache=U.malloc('__MODULE');if(cache(k)){throw new Error("Duplicate module: '"+k+"'.");}cache(k,new Co());},
    MODULE: function(k){if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}var cache=U.malloc('__MODULE');return cache(k)||null;},
    procSerial: function(){var Co=function(){var self=this;self.queue=[];self.ctx={};};Co.prototype.push=function(fn){var self=this;var args=(arguments&&arguments.length>0)?[].slice.call(arguments,1):[];self.queue.push({fn:fn,args:args});};Co.prototype.run=function(endFN){var self=this;(function loop(i,args){var obj=self.queue[i];if(!obj){return endFN&&endFN.call(self.ctx,null);}if(i===0||(Array.isArray(obj.args)&&obj.args.length>0)){obj.args.push(next);obj.fn.apply(self.ctx,obj.args);}else{args.push(next);obj.fn.apply(self.ctx,args);}function next(){var args=(arguments&&arguments.length>0)?[].slice.call(arguments):[];var err=args.shift();if(err){return endFN&&endFN.call(self.ctx,err);}if(typeof(setImmediate)==='function'){setImmediate(function(){return loop(++i,args);});}else{return loop(++i,args);}}}(0));};return new Co();},
    ajax: function(obj){var xhr=new XMLHttpRequest();var res=null;var json='application/json';xhr.onreadystatechange=function(){if(xhr.readyState===4){if(obj.header['Accept']===json){try{res=JSON.parse(xhr.responseText);}catch(err){U.logWarn('Unable to parse server response to JSON.');obj.error(null,xhr);}}else{res=xhr.responseText;}if(xhr.status===200){obj.success(res,xhr);}else{obj.error(res,xhr);}obj.always(res,xhr);}};xhr.upload.onprogress=function(state){if(state.lengthComputable){var percentage=(state.loaded/state.total)*100;obj.progress(percentage.toFixed(0));}};xhr.onerror=function(){U.logWarn('Unexpected AJAX error.');};xhr.open(obj.method,obj.url,true);for(var k in obj.header){if(obj.hasOwnProperty(k)){var v=obj.header[k];xhr.setRequestHeader(k,v);}}xhr.send(obj.data);},
    domReady: function(fn){if(document.attachEvent?(document.readyState==='complete'):(document.readyState!=='loading')){fn();}else{document.addEventListener('DOMContentLoaded',fn);}},
    domIsEl: function(el){return(el instanceof Node||el instanceof Element||el instanceof HTMLDocument);},
    domMatches: function(el,sel){var p=Element.prototype;var fn=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.msMatchesSelector||function(s){return Array.prototype.indexOf.call(document.querySelectorAll(s),this)!==-1;};return fn.call(el,sel);},
    domFind: function(sel,el){var list=null;if(!sel||typeof(sel)!=='string'){throw new Error('invalidParameter');}if(el&&U.domIsEl(el)){list=el.querySelectorAll(sel);}else{list=document.querySelectorAll(sel);}if(list){if(selectingOne(sel)){return list[0]||null;}else{var arr=[];var len=list.length;arr.length=len;for(var i=0;i<len;i++){if(list[i]){arr[i]=list[i];}}return arr;}}else{if(selectingOne(sel)){return null;}return[];}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domHasClass: function(el,name){if(!el||!U.domIsEl(el)){throw new Error('invalidParameter');}if(el.classList){return el.classList.contains(name);}else{var exp=new RegExp('(^| )'+name+'( |$)','gi');return exp.test(el.className);}},
    domAddClass: function(sel,v){if(!sel){throw new Error('invalidParameter');}if(!v||typeof(v)!=='string'){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){var len=els.length;for(var i=0;i<len;i++){var el=els[i];if(!el){continue;}var clas=v.split(/\s+/);var lenlen=clas.length;for(var j=0;j<lenlen;j++){var cla=clas[j];addClass(el,cla);}}}function addClass(el,v){if(el.classList){el.classList.add(v);}else{el.className+=' '+v;}}},
    domRemoveClass: function(sel,v){if(!sel||!v||typeof(v)!=='string'){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){var len=els.length;for(var i=0;i<len;i++){var el=els[i];if(!el){continue;}var clas=v.split(/\s+/);var lenlen=clas.length;for(var j=0;j<lenlen;j++){var cla=clas[j];removeClass(el,cla);}}}function removeClass(el,v){if(el.classList){el.classList.remove(v);}else{el.className=el.className.replace(new RegExp('(^|\\b)'+v.split(' ').join('|')+'(\\b|$)','gi'),' ');}}},
    domToggleClass: function(sel,v){if(!sel){throw new Error('invalidParameter');}if(!v||typeof(v)!=='string'){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){var len=els.length;for(var i=0;i<len;i++){var el=els[i];if(!el){continue;}var clas=v.split(/\s+/);var lenlen=clas.length;for(var j=0;j<lenlen;j++){var cla=clas[j];toggleClass(el,cla);}}}function toggleClass(el,v){el.classList.toggle(v);}},
    domVal: function(sel,v){if(!sel){throw new Error('invalidParameter');}if(v&&typeof(v)!=='string'&&isNaN(parseInt(v))){return new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(!el){continue;}if(v===undefined){arr.push(getVal(el));}else{setVal(el,v);}}}return selectingOne(sel)?arr[0]:arr;function getVal(el){return el.value||null;}function setVal(el,v){el.value=v;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domAttr: function(sel,k,v){if(!sel){throw new Error('invalidParameter');}if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}if(v&&typeof(v)!=='string'&&isNaN(parseInt(v))&&v!==null){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(!el){continue;}if(v===undefined){arr.push(getAttr(el,k));}else{setAttr(el,k,v);}}}return selectingOne(sel)?arr[0]:arr;function getAttr(el,k){var v=el.getAttribute(k)||null;if(v){return v;}else{return el.hasAttribute(k);}}function setAttr(el,k,v){el.setAttribute(k,''+v);}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domData: function(sel,k,v){if(!sel){throw new Error('invalidParameter');}if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}try{v=normalizeVal(v);}catch(err){throw new Error('unableToParse');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(!el){continue;}if(v===undefined){arr.push(getData(el,k));}else{setData(el,k,v);}}}return selectingOne(sel)?arr[0]:arr;function getData(el,k){if(el.__elementData&&el.__elementData[k]){return el.__elementData[k];}return el.dataset[k]||null;}function setData(el,k,v){if(typeof(v)==='string'){el.dataset[k]=v;}else{if(!el.__elementData){el.__elementData={};}el.__elementData[k]=v;}}function normalizeVal(v){if(v===undefined){return undefined;}else if(typeof(v)==='string'){return v;}else if(typeof(v)==='object'){if(!v){return null;}return v;}else if(v&&typeof(v.toString)=='function'){return v.toString();}else{throw new Error('invalidParameter');}}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domHTML: function(sel,v){if(!sel){throw new Error('invalidParameter');}if(v&&typeof(v)!=='string'){return new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(!el){continue;}if(v===undefined){arr.push(getHtml(el));}else{setHtml(el,v);}}}return selectingOne(sel)?arr[0]:arr;function getHtml(el){return el.innerHTML||null;}function setHtml(el,v){el.innerHTML=v;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domText: function(sel,v){if(!sel){throw new Error('invalidParameter');}if(v&&typeof(v)!=='string'){return new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(!el){continue;}if(v===undefined){arr.push(getText(el));}else{setText(el,v);}}}return selectingOne(sel)?arr[0]:arr;function getText(el){return el.textContent||null;}function setText(el,v){el.textContent=v;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domParent: function(sel){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){arr.push(getParent(el));}}}return selectingOne(sel)?arr[0]:arr;function getParent(el){return el.parentNode||null;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domChildren: function(sel){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){arr.push(getChildren(el));}}}return selectingOne(sel)?arr[0]:arr;function getChildren(el){var els=el.children||[];var arr=[];for(var i=0;i<els.length;i++){arr[i]=els[i];}return arr;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domSiblings: function(sel){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){arr.push(getSiblings(el));}}}return selectingOne(sel)?arr[0]:arr;function getSiblings(el){var els=(el.parentNode&&el.parentNode.children)?el.parentNode.children:[];var arr=[];for(var i=0;i<els.length;i++){var ch=els[i];if(ch!==el){arr.push(ch);}}return arr;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domPrev: function(sel){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){arr.push(getPrev(el));}}}return selectingOne(sel)?arr[0]:arr;function getPrev(el,psel){var els=(el.parentNode&&el.parentNode.children)?el.parentNode.children:[];var brk=false;for(var i=els.length-1;i>=0;i--){var sib=els[i];if(sib===el){brk=true;continue;}if(brk&&sib&&(U.domMatches(sib,psel)||!psel)){return sib;}else{continue;}}return null;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domPrevAll: function(sel){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){arr.push(getPrevAll(el));}}}return selectingOne(sel)?arr[0]:arr;function getPrevAll(el){var els=(el.parentNode&&el.parentNode.children)?el.parentNode.children:[];var arr=[];for(var i=0;i<els.length;i++){var ch=els[i];if(ch===el){return arr;}arr.push(ch);}return[];}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domNext: function(sel,nsel){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){arr.push(getNext(el,nsel));}}}return selectingOne(sel)?arr[0]:arr;function getNext(el,nsel){var els=(el.parentNode&&el.parentNode.children)?el.parentNode.children:[];var brk=false;for(var i=0;i<els.length;i++){var sib=els[i];if(sib===el){brk=true;continue;}if(brk&&sib&&(U.domMatches(sib,nsel)||!nsel)){return sib;}else{continue;}}return null;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domNextAll: function(sel){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){arr.push(getNextAll(el));}}}return selectingOne(sel)?arr[0]:arr;function getNextAll(el){var els=(el.parentNode&&el.parentNode.children)?el.parentNode.children:[];var arr=[];var brk=false;for(var i=0;i<els.length;i++){var ch=els[i];if(brk){arr.push(ch);}if(ch===el){brk=true;}}return arr;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domStyle: function(sel,k,v){if(!sel){throw new Error('invalidParameter');}if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}if(v&&(typeof(v)!=='string'&&isNaN(parseInt(v)))){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}var arr=[];if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(!el){continue;}if(v===undefined){arr.push(getStyle(el,k));}else{setStyle(el,k,v);}}}return selectingOne(sel)?arr[0]:arr;function getStyle(el,k){return el.style[k]||null;}function setStyle(el,k,v){el.style[k]=v;}function selectingOne(sel){if(U.domIsEl(sel)){return true;}else if(typeof(sel)==='string'){var parts=sel.split(/\s+/);return(parts&&parts.length==1&&parts[0][0]=='#');}return false;}},
    domFadeIn: function(sel,t){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){fadeIn(el,t);}}}function fadeIn(el,t){el.style.transition='opacity '+(t&&!isNaN(t)&&t>0?t:250)+'ms';el.style.opacity='1';}},
    domFadeOut: function(sel,t){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){fadeOut(el,t);}}}function fadeOut(el,t){el.style.transition='opacity '+(t&&!isNaN(t)&&t>0?t:250)+'ms';el.style.opacity='0';}},
    domFadeTo: function(sel,o,t){if(!sel){throw new Error('invalidParameter');}if(!o||isNaN(o)||o>100||o<0){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){for(var i=0,len=els.length;i<len;i++){var el=els[i];if(el){fadeTo(el,o,t);}}}function fadeTo(el,o,t){el.style.transition='opacity '+(t&&!isNaN(t)&&t>0?t:250)+'ms';el.style.opacity=o.toString();}},
    domFadeToggle: function(sel,t){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){for(var i=0,len=els.length;i<len;i++){var el=els[i];if(el){fadeToggle(el);}}}function fadeToggle(el){el.style.transition='opacity '+(t&&!isNaN(t)&&t>0?t:250)+'ms';var s=el.ownerDocument.defaultView.getComputedStyle(el,null);var o=(!s)?null:s.opacity;if(o===null){return;}if(o==='1'){el.style.opacity='0';}else{el.style.opacity='1';}}},
    domOn: function(sel,k,fn){if(!sel){throw new Error('invalidParameter');}if(!k||typeof(k)!=='string'||typeof(fn)!=='function'){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){var len=els.length;for(var i=0;i<len;i++){var el=els[i];if(el){addListener(el,k,fn);}}}function addListener(el,k,fn){var cache=U.malloc('__DOM');var handler=cache('handler')||{};if(!handler[el]){handler[el]={};}if(!handler[el][k]){handler[el][k]=[];}handler[el][k].push(fn);el.addEventListener(k,fn,false);cache('handler',handler);}},
    domOff: function(sel,k){if(!sel){throw new Error('invalidParameter');}if(k&&typeof(k)!=='string'){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){var len=els.length;for(var i=0;i<len;i++){var el=els[i];if(el){els[i]=removeListener(el,k||null);}}}function removeListener(el,k){var cache=U.malloc('__DOM');var handler=cache('handler')||{};var replacer=el;if(k){if(handler[el]&&handler[el][k]){var fns=handler[el][k];for(var i=0;i<fns.length;i++){var fn=fns[i];el.removeEventListener(k,fn,false);}handler[el][k]=null;}}else{var copy=el.cloneNode(true);el.parentNode.replaceChild(copy,el);handler[el]=null;replacer=copy;}cache('handler',handler);return replacer;}},
    domTriggerNativeEvent: function(sel,k){if(!sel){throw new Error('invalidParameter');}if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){var len=els.length;for(var i=0;i<len;i++){var el=els[i];if(el){triggerEvent(el,k);}}}function triggerEvent(el,k){var e=document.createEvent('HTMLEvents');e.initEvent(k,true,false);el.dispatchEvent(e);}},
    domTriggerEvent: function(sel,k,v){if(!sel){throw new Error('invalidParameter');}if(!k||typeof(k)!=='string'){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){var len=els.length;for(var i=0;i<len;i++){var el=els[i];if(el){triggerEvent(el,k,v);}}}function triggerEvent(el,k,v){var e=null;if(window.CustomEvent){e=new CustomEvent(k,{detail:v});}else{e=document.createEvent('CustomEvent');e.initCustomEvent(k,true,true,v);}el.dispatchEvent(e);}},
    domAppend: function(sel,v){if(!sel){throw new Error('invalidParameter');}if(typeof(v)!=='string'){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){domAppend(el,v);}}}function domAppend(el,v){el.insertAdjacentHTML('beforeend',v);}},
    domPrepend: function(sel,v){if(!sel){throw new Error('invalidParameter');}if(typeof(v)!=='string'){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){domPrepend(el,v);}}}function domPrepend(el,v){el.insertAdjacentHTML('afterbegin',v);}},
    domRemove: function(sel){if(!sel){throw new Error('invalidParameter');}var els=null;if(Array.isArray(sel)){els=sel;}else if(U.domIsEl(sel)){els=[sel];}else{els=U.domFind(sel);els=Array.isArray(els)?els:[els];}if(Array.isArray(els)){for(var i=0;i<els.length;i++){var el=els[i];if(el){domRemove(el);}}}function domRemove(el){el.parentNode.removeChild(el);}}
};if(typeof(process)==='object'&&typeof(module)==='object'){module.exports=U};