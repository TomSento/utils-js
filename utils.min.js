var U = {
    moduleName: 'DefaultModule',
    version: '1.0.0',
    utilsVersion: '1.0.0',
    SID: function(l){var chars='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';var len=chars.length;var lenID=(l&&!isNaN(l))?l:5;var str='';for(var i=0;i<lenID;i++){str+=chars.charAt(Math.floor(Math.random()*len));}return str;},
    UID: function(){return Math.ceil(Date.now()/1000)+'-'+U.SID(3);},
    objectKeys: function(obj){var keys=[];var k;for(k in obj){if(Object.prototype.hasOwnProperty.call(obj,k)){keys.push(k);}}return keys;},
    forIn: function(object,fn){var len=U.objectKeys(object).length;var i=0;for(var key in object){if(object.hasOwnProperty(key)){var first=(i==0);var last=((i+1)==len);fn(key,object[key],first,last);i++;}}},
    forEach: function(arr,fn){var len=arr.length;for(var i=0;i<len;i++){var first=(i==0);var last=((i+1)==len);fn(arr[i],i,arr,first,last);}},
    map: function(arr,fn){var temp=[];for(var i=0;i<this.length;i++){temp.push(fn(arr[i],i,arr));}return temp;},
    filter: function(arr,fn){var acc=[];for(var i=0;i<arr.length;i++){if(fn.call(null,arr[i],i,arr)){acc.push(arr[i]);}}return acc;},
    reduce: function(arr,fn,initialVal){var acc=(initialVal===undefined)?undefined:initialVal;for(var i=0;i<arr.length;i++){if(acc!==undefined)acc=fn.call(undefined,acc,arr[i],i,arr);else acc=arr[i];}return acc;},
    clone: function(obj,skip,skipFunctions){if(!obj){return obj;}var type=typeof(obj);if(type!=='object'||obj instanceof Date){return obj;}var length;var o;if(obj instanceof Array){length=obj.length;o=new Array(length);for(var i=0;i<length;i++){type=typeof(obj[i]);if(type!=='object'||obj[i]instanceof Date){if(skipFunctions&&type==='function'){continue;}o[i]=obj[i];continue;}o[i]=U.clone(obj[i],skip,skipFunctions);}return o;}o={};for(var m in obj){if(skip&&skip[m]){continue;}var val=obj[m];var type=typeof(val);if(type!=='object'||val instanceof Date){if(skipFunctions&&type==='function'){continue;}o[m]=val;continue;}o[m]=U.clone(obj[m],skip,skipFunctions);}return o;},
    contains: function(item,searchValue){if(typeof(item)=='string'){if(item.indexOf(searchValue)!==-1){return true;}}if(Array.isArray(item)){if(item.indexOf(searchValue)!==-1){return true;}}return false;},
    extend: function(target,source,rewrite){if(!target||!source){return target;}if(typeof(target)!=='object'||typeof(source)!=='object'){return target;}if(rewrite===undefined){rewrite=true;}var keys=Object.keys(source);var i=keys.length;while(i--){var key=keys[i];if(rewrite||target[key]===undefined){target[key]=U.clone(source[key]);}}return target;},
    toQueryString: function(obj,base){var queryString=[];Object.each(obj,function(v,k){if(base)k=base+'['+k+']';var result;switch(typeOf(v)){case'object':result=Object.toQueryString(v,k);break;case'array':var qs={};v.each(function(val,i){qs[i]=val;});result=Object.toQueryString(qs,k);break;default:result=k+'='+encodeURIComponent(v);}if(v!=null)queryString.push(result);});return queryString.join('&');},
    argsToDebugString: function(args){var logs='';for(var i=0;i<arguments.length;i++){var arg=arguments[i];if(arg){if(typeof arg=='object'||Array.isArray(arg)){if(Array.isArray(arg)){logs+='Array('+arg.length+'): \n';}else if(typeof arg=='object'){logs+='Object: \n';}logs+=JSON.stringify(arg,null,'\t');logs+='\n';}else{logs+=arg;}}else{logs+=' '+arg;}}return logs;},
    strFormat: function(str,args){return str.replace(/\{\d+\}/g,function(text){var value=args[+text.substring(1,text.length-1)];return value===null?'':value;});},
    strHyphenize: function(str){if(typeof(str)!=='string'){return null;}return str.replace(/\B([A-Z])/g,function(g){return('-'+g[0]);}).toLowerCase();},
    strHtml: function(tag,obj){if(!tag||typeof(tag)!='string'){return'';}var pairables=['area','base','br','col','command','embed','hr','img','input','keygen','link','meta','param','source','track','wbr'];var str='<'+tag;if(!obj){obj={};}if(obj.id){str+=' id="'+obj.id+'"';}if(obj.classes&&Array.isArray(obj.classes)){str+=classesAsStr(obj);}if(obj.style&&typeof(obj.data=='object')){str+=stylesAsStr(obj.style);}str+=attrsAsStr(obj);if(obj.data&&typeof(obj.data)=='object'){str+=dataAttrsAsStr(obj.data);}if(pairables.indexOf(tag)>=0){return str+'/>';}str+='>';str+=obj.html;str+='</'+tag+'>';return str;function classesAsStr(obj){var arr=obj.classes;var str='';for(var i=0;i<arr.length;i++){var v=arr[i];if(v){v='.'+v;}}str=obj.classes.join(' ');return(str.length>0)?(' class="'+str)+'"':'';}function attrsAsStr(obj){obj=(typeof(obj)=='object')?obj:{};var str='';for(var k in obj){if(['id','classes','style','data','html'].indexOf(k)>=0){continue;}var attr=k+'="'+obj[k]+'"';str+=(str.length>0)?(' '+attr):attr;}return(str.length>0)?(' '+str):'';}function dataAttrsAsStr(obj){var str='';for(var k in obj){if(obj.hasOwnProperty(k)){var attr='data-'+k+'="'+obj[k]+'"';str+=(str.length>0)?(' '+attr):attr;}}return(str.length>0)?(' '+str):'';}function stylesAsStr(obj){var str='';for(var k in obj){str+=U.strHyphenize(k)+':'+obj[k]+';';}return(str.length>0)?(' style="'+str+'"'):'';}},
    logDebug: function(){var log=U.argsToDebugString.apply(this,arguments);console.log(U.moduleName+': '+log);},
    logInfo: function(){var args=[].slice.call(arguments);args.unshift(U.moduleName+': ');console.log.apply(null,args);},
    logWarn: function(){var args=[].slice.call(arguments);args.unshift(U.moduleName+': ');console.warn.apply(null,args);},
    error: function(problem,message){var Co=function(problem,message){if(!problem){throw new Error('missingProblem');}message=message||null;if(problem instanceof Error){this.id=problem.message;this.message=message;}else if(typeof(problem)=='string'){this.id=problem;this.message=message;}else{throw new Error('invalidProblem');}};Co.prototype={throw:function(){throw new Error(this.id);},toString:function(){return JSON.stringify({id:this.id,message:this.message},null,'    ');}};return new Co(problem,message);},
    ErrorBuilder: function(errors){var Co=function(){if(errors){if(!Array.isArray(errors)){throw new Error('invalidParameter');}for(var i=0;i<errors.length;i++){if(!errors[i]||!(errors[i]instanceof ErrorPair)){throw new Error('invalidArrayItem');}}}this.errors=errors||[];};Co.prototype={push:function(errorPair){this.errors.push(errorPair);},remove:function(id){var arr=this.errors;var idx=-1;for(var i=0;i<arr.length;i++){if(arr[i].id==id){idx=i;}}if(idx>-1){arr.splice(idx,1);}},clear:function(){this.errors=[];},toString:function(){return JSON.stringify(this,null,'    ');}};return new Co(errors);},
    SerialFlow: function(result){var Co=function(result){var self=this;self.fnArray=[];self.context={result:(typeof(context)=='object')?result:{}};};Co.prototype.push=function(fn){var args=arguments&&arguments.length&&Array.prototype.slice.call(arguments,1)||[];var self=this;var argArray=args;self.fnArray.push({fn:fn,argArray:argArray});};Co.prototype.run=function(end){var self=this;(function loop(i,argArray){var obj=self.fnArray[i];if(!obj){return end&&end(null,self.context.result);}if(i===0||(Array.isArray(obj.argArray)&&obj.argArray.length>0)){obj.argArray.push(next);obj.fn.apply(self.context,obj.argArray);}else{argArray.push(next);obj.fn.apply(self.context,argArray);}function next(){var args=arguments&&arguments.length&&Array.prototype.slice.call(arguments)||[];var err=args.shift();if(err){return end&&end(err,self.context.result);}if(typeof(setImmediate)=='function'){setImmediate(function(){return loop(++i,args);});}else{return loop(++i,args);}}})(0);};return new Co(result);},
    ajax: function(obj){var xhr=new XMLHttpRequest();var res=null;var json='application/json';xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status===200){if(obj.header['Accept'===json]){try{res=JSON.parse(xhr.responseText);}catch(err){console.warn('Ajax: Unable to parse success server response to JSON.');obj.error(null,xhr);}}else{res=xhr.responseText;}obj.success(res,xhr);}else{if(obj.header['Accept']===json){try{res=JSON.parse(xhr.responseText);}catch(err){console.warn('Ajax: Unable to parse error server response to JSON.');obj.error(null,xhr);}}else{res=xhr.responseText;}obj.error(res,xhr);}}};xhr.upload.onprogress=function(state){if(state.lengthComputable){var percentage=(state.loaded/state.total)*100;obj.progress(percentage.toFixed(2));}};xhr.onerror=function(){console.warn('Ajax: Unexpected ajax error.');};xhr.open(obj.method,url,true);for(var k in obj.header){var v=obj[k];xhr.setRequestHeader(k,v);}xhr.send(obj.data);},
    domReady: function(fn){if(document.attachEvent?(document.readyState==="complete"):(document.readyState!=="loading")){fn();}else{document.addEventListener('DOMContentLoaded',fn);}},
    isDomEl: function(el){return(el instanceof Element);},
    domFind: function(selector,parent){var el=(parent&&U.isDomEl(parent))?parent:document;var op=null;var type=selector[0];var map={'#':'getElementById','.':'getElementsByClassName','=':'getElementsByTagName','*':'querySelectorAll'};var op=map[type];if(!op){return[];}var arr=document[op](selector.slice(1));if(type=='#'){return arr||null;}return Array.isArray(arr)?arr:[];},
    domHasClass: function(el,name){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}if(el.classList){return el.classList.contains(name);}else{var exp=new RegExp('(^| )'+name+'( |$)','gi');return exp.test(el.className);}},
    domAddClass: function(el,name){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}if(el.classList){el.classList.add(name);}else{el.className+=' '+name;}},
    domRemoveClass: function(el,name){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}if(el.classList){el.classList.remove(name);}else{el.className=el.className.replace(new RegExp('(^|\\b)'+name.split(' ').join('|')+'(\\b|$)','gi'),' ');}},
    domToggleClass: function(el,name){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}el.classList.toggle(className);},
    domAttr: function(el,k,v){if(!el||!U.isDomEl(el)||!k){throw new Error('invalidParameter');}if(v===undefined){return el.getAttribute(k);}else{el.setAttribute(k,v);}},
    domData: function(el,k,v){if(!el||!U.isDomEl(el)||!k){throw new Error('invalidParameter');}if(v===undefined){return el.dataset[k];}else{el.dataset[k]=v;}},
    domHtml: function(el,str){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}if(typeof(str)=='string'){el.innerHTML=str;}else{return el.innerHTML;}},
    domText: function(el,str){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}if(typeof(str)=='string'){el.textContent=str;}else{return el.textContent;}},
    domParent: function(el){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}return el.parentNode||null;},
    domChildren: function(el){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}return Array.isArray(el.children)?el.children:[];},
    domSiblings: function(el){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}var arr=(el.parentNode&&Array.isArray(el.parentNode.children))?el.parentNode.children:[];var acc=[];for(var i=0;i<arr.length;i++){var ch=arr[i];if(ch!==el){acc.push(ch);}}return acc;},
    domFadeIn: function(el,t){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}el.style.transition='opacity '+(t&&!isNaN(t)&&t>0?t:1000);el.style.opacity='0';},
    domFadeOut: function(el,t){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}el.style.transition='opacity '+(t&&!isNaN(t)&&t>0?t:1000);el.style.opacity='1';},
    domFadeTo: function(el,o,t){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}if(!o||isNaN(o)||o>100||o<0){throw new Error('invalidParameter');}el.style.transition='opacity '+(t&&!isNaN(t)&&t>0?t:1000);el.style.opacity=o.toString();},
    domFadeToggle: function(el,t){if(!el||!U.isDomEl(el)){throw new Error('invalidParameter');}el.style.transition='opacity '+(t&&!isNaN(t)&&t>0?t:1000);var s=el.ownerDocument.defaultView.getComputedStyle(el,null);var o=(!s)?null:s.opacity;if(o===null){return;}if(o==='1'){el.style.opacity='0';}else{el.style.opacity='1';}},
}
